name: release

on:
  push:
    tags: [ v*.*.* ]

jobs:

  setup:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

  build:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - uses: jkstack/smartagent-build@1.19.1

  release:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: jkstack/smartagent-release@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}